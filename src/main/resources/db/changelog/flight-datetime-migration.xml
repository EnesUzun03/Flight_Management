<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
    http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">

    <changeSet id="2" author="enes">
        <comment>Merge departure_time and departure_date columns into single departure_datetime column</comment>
        
        <!-- Önce yeni sütunu ekle -->
        <addColumn tableName="flight">
            <column name="departure_datetime" type="TIMESTAMP">
                <constraints nullable="true"/>
            </column>
        </addColumn>
        
        <!-- Mevcut veriler varsa, bunları birleştir (örnek veri varsa) -->
        <!-- Bu adım opsiyonel - eğer veri yoksa skip edilebilir -->
        <sql>
            UPDATE flight 
            SET departure_datetime = departure_date + departure_time 
            WHERE departure_date IS NOT NULL AND departure_time IS NOT NULL;
        </sql>
        
        <!-- Eski sütunları sil -->
        <dropColumn tableName="flight" columnName="departure_time"/>
        <dropColumn tableName="flight" columnName="departure_date"/>
    </changeSet>
</databaseChangeLog>